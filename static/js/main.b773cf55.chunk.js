(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{18:function(e,t,n){},5:function(e,t,n){e.exports=n(6)},6:function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),s=(n(2),n(9),n(4)),c=n.n(s),i=(n(18),n(1)),p=n.n(i),l="https://cors-anywhere.herokuapp.com/",d=7245851;function u(e,t,n,a){var o=this,s="";for(var c in n){s+='<input id="in'+(u=c-0+1)+e+'" type = "text" class = "ctr_inp">'}document.getElementById("root").innerHTML="<div class = 'mem' ><input id=\"back"+e+'" type = "submit" value="\u041d\u0430\u0437\u0430\u0434" class = "ctr_inp">'+s+'<canvas id="cvs'+e+'" class = "cvs"></canvas>\n    <input id="dvl'+e+'" type = "submit" value="\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c" class = "ctr_inp"></div> "';var i=document.getElementById("cvs"+e),p=i.getContext("2d"),l=new Image;l.src=t,l.onload=function(){for(var e in i.height=l.height,i.width=l.width,p.drawImage(l,0,0),n)p.font="bold  50px Verdana",p.fillStyle=a,p.textAlign="center",p.fillText(n[e].text,n[e].x,n[e].y)},this.write=function(e){for(var t in p.clearRect(0,0,i.width,i.height),p.drawImage(l,0,0),n){var o=e[t].value,r=o.length;if(r<=n[t].max_size)p.font="bold  50px Verdana",p.fillStyle=a,p.textAlign="center",p.fillText(e[t].value,n[t].x,n[t].y);else for(var s=r/n[t].max_size,c=o.split(" "),d=c.length,u=0,m=0;m<s;m++){for(var h="",f=0;f<d/s;f++)void 0!=c[u]&&(h+=c[u]+" "),u++;p.font="bold  50px Verdana",p.fillStyle=a,p.textAlign="center",p.fillText(h,n[t].x,n[t].y+40*m)}}};var d=[];for(var c in n){var u=c-0+1;d[c]=document.getElementById("in"+u+e),d[c].value=n[c].text,d[c].oninput=function(){o.write(d)}}document.getElementById("dvl"+e).onclick=function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.awrap(x(i.toDataURL()));case 2:case"end":return e.stop()}}))},document.getElementById("back"+e).onclick=function(){h()}}function m(e,t,n,a){var o;(o=new Image).src=t,o.className="mem_img",o.id="mem_img"+e,document.getElementById("root").append(o),(o=document.getElementById("mem_img"+e)).onclick=function(){new u(e,t,n,a)}}function h(){document.getElementById("root").innerHTML="",new m(1,"mem1.jpg",[{text:"No",x:700,y:100,max_size:7},{text:"Yes",x:700,y:600,max_size:7}],"#000000"),new m(2,"mem5.jpg",[{text:"Oyhh",x:350,y:350,max_size:20}],"#FFFFFF"),new m(3,"mem6.jpg",[{text:"Lapotaa",x:350,y:350,max_size:20}],"#FFFFFF")}p.a.subscribe((function(e){var t=e.detail,n=t.type,o=t.data;console.log("\u0442\u0438\u043f: "+n),console.log(10),"VKWebAppAccessTokenReceived"==n&&(a=o.access_token),"VKWebAppCallAPIMethodFailed"==n&&console.log(o.error_data)})),p.a.send("VKWebAppInit",{}),h(),p.a.send("VKWebAppGetAuthToken",{app_id:7245851,scope:"friends,photos"});var f=function(e){var t=e.getReader(),n=[];return function e(){return t.read().then((function(t){var a=t.value;return t.done?n:(n.push(a),e())}))}()};function v(e,t,n){return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",c()(e).then((function(e){return f(e.body)})).then((function(e){return new File(e,t,{type:n})})));case 1:case"end":return a.stop()}}))}function x(e){var t,n,o,s,c,i,u,m,h,f,x;return r.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,r.a.awrap(p.a.send("VKWebAppGetAuthToken",{app_id:d,scope:"photos"}));case 2:return g.sent,g.next=5,r.a.awrap(p.a.send("VKWebAppCallAPIMethod",{method:"photos.getWallUploadServer",params:{access_token:a,v:"5.95"}}));case 5:return t=g.sent,n=t.data.response.upload_url,o=new FormData,g.t0=o,g.next=11,r.a.awrap(v(e,"story.png","image/png"));case 11:return g.t1=g.sent,g.t0.append.call(g.t0,"photo",g.t1),g.next=15,r.a.awrap(fetch(l+n,{method:"POST",body:o}).then((function(e){return e.json()})));case 15:return s=g.sent,c=s.server,i=s.photo,u=s.hash,g.next=21,r.a.awrap(p.a.send("VKWebAppCallAPIMethod",{method:"photos.saveWallPhoto",params:{access_token:a,server:c,photo:i,hash:u,v:"5.95"}}));case 21:return m=g.sent,h=m.data.response[0],f=h.id,x=h.owner_id,g.next=25,r.a.awrap(p.a.send("VKWebAppShowWallPostBox",{message:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0430 \u0441\u0442\u0435\u043d\u0443 \u0441 \u0444\u043e\u0442\u043e",attachments:"photo".concat(x,"_").concat(f,",https://vk.com/app").concat(d)}));case 25:case"end":return g.stop()}}))}}},[[5,1,2]]]);
//# sourceMappingURL=main.b773cf55.chunk.js.map