(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{18:function(e,t,n){},5:function(e,t,n){e.exports=n(6)},6:function(e,t,n){"use strict";n.r(t);var o,s,a=n(0),c=n.n(a),r=(n(2),n(9),n(4)),l=n.n(r),m=(n(18),n(1)),i=n.n(m),p="https://cors-anywhere.herokuapp.com/",u=7245851;function d(e,t,n,o,s){var a=this,r="";for(var l in n){r+='<input id="in'+(d=l-0+1)+e+'" type = "text" class = "ctr_inp">'}document.getElementById("root").innerHTML="<div class = 'mem' ><input id=\"back"+e+'" type = "submit" value="\u041d\u0430\u0437\u0430\u0434" class = "ctr_inp">'+r+'<canvas id="cvs'+e+'" class = "cvs"></canvas>\n    <input id="dvl'+e+'" type = "submit" value="\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c" class = "ctr_inp"></div>';var m=document.getElementById("cvs"+e),i=m.getContext("2d"),p=new Image;p.src=t,p.onload=function(){for(var e in m.height=p.height,m.width=p.width,i.drawImage(p,0,0),n)i.font="bold  "+s+"px Verdana",i.fillStyle=o,i.textAlign="center",i.fillText(n[e].text,n[e].x,n[e].y)},this.write=function(e){for(var t in i.clearRect(0,0,m.width,m.height),i.drawImage(p,0,0),n){var a=e[t].value,c=a.length;if(c<=n[t].max_size)i.font="bold  "+s+"px Verdana",i.fillStyle=o,i.textAlign="center",i.fillText(e[t].value,n[t].x,n[t].y);else for(var r=c/n[t].max_size,l=a.split(" "),u=l.length,d=0,g=0;g<r;g++){for(var x="",h=0;h<u/r;h++)void 0!=l[d]&&(x+=l[d]+" "),d++;i.font="bold  "+s+"px Verdana",i.fillStyle=o,i.textAlign="center",i.fillText(x,n[t].x,n[t].y+s*g)}}};var u=[];for(var l in n){var d=l-0+1;u[l]=document.getElementById("in"+d+e),u[l].value=n[l].text,u[l].oninput=function(){a.write(u)}}var g=document.getElementById("dvl"+e);g.onclick=function(){var e;return c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:for(e in u)u[e].remove();return m.style.marginTop="20px",g.value="\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043c\u0435\u043c\u0430 ...",g.onclick=null,t.next=6,c.a.awrap(F(m.toDataURL(),g));case 6:g.value="\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u0434\u0438\u0430\u043b\u043e\u0433";case 7:case"end":return t.stop()}}))},document.getElementById("back"+e).onclick=function(){x()}}function g(e,t,n,o,s){var a;(a=new Image).src=t,a.className="mem_img",a.id="mem_img"+e,document.getElementById("mem_list").append(a),(a=document.getElementById("mem_img"+e)).onclick=function(){new d(e,t,n,o,s)}}function x(){document.getElementById("root").innerHTML="",document.getElementById("root").innerHTML="<div class = 'line_lable' ><a  class = 'href'  href='https://vk.com/public189857738'>Go \u0432 \u041c\u0435\u043c\u043d\u0438\u0446\u0443</a>  </div>  <div class = 'line_line' > <input type  = 'button' class = 'btn_btn' value = '\u041d\u043e\u0432\u0438\u043d\u043a\u0438' id='kt1'> <input id='kt2' type  = 'button' class = 'btn_btn' value = '\u0418\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0435'>  <input id='kt3' type  = 'button' class = 'btn_btn' value = '\u0411\u0430\u044f\u043d\u044b'> </div>",document.getElementById("kt1").onclick=function(){document.getElementById("kt1").className="btn_select",document.getElementById("kt2").className="btn_btn",document.getElementById("kt3").className="btn_btn",document.getElementById("mem_list").innerHTML="",new g(5,"mem8.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(2,"mem5.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(3,"mem6.jpg",[{text:"Lapotaa",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(1,"mem1.jpg",[{text:"No",x:700,y:100,max_size:7},{text:"Yes",x:700,y:600,max_size:7}],"#000000",50)},document.getElementById("kt2").onclick=function(){document.getElementById("kt1").className="btn_btn",document.getElementById("kt2").className="btn_select",document.getElementById("kt3").className="btn_btn",document.getElementById("mem_list").innerHTML="",new g(5,"mem8.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(6,"mem9.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#000000",50),new g(7,"mem10.jpg",[{text:"Oyhh",x:1e3,y:1e3,max_size:20}],"#FFFFFF",100),new g(4,"mem7.jpg",[{text:"No",x:150,y:60,max_size:7},{text:"Yes",x:150,y:150,max_size:7}],"#000000",10)},document.getElementById("kt3").onclick=function(){document.getElementById("kt1").className="btn_btn",document.getElementById("kt2").className="btn_btn",document.getElementById("kt3").className="btn_select",document.getElementById("mem_list").innerHTML="",new g(2,"mem5.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(3,"mem6.jpg",[{text:"Lapotaa",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(5,"mem8.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(6,"mem9.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#000000",50),new g(7,"mem10.jpg",[{text:"Oyhh",x:1e3,y:1e3,max_size:20}],"#FFFFFF",100)};var e=document.createElement("div");e.className="mem_list",e.id="mem_list",document.getElementById("root").append(e),function(){var e=document.createElement("input");e.className="bottom_input",e.id="bottom_input",e.type="button",e.value="\u0421\u0432\u043e\u0439 \u0448\u0430\u0431\u043b\u043e\u043d",document.getElementById("root").append(e)}(),new g(2,"mem5.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(3,"mem6.jpg",[{text:"Lapotaa",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(1,"mem1.jpg",[{text:"No",x:700,y:100,max_size:7},{text:"Yes",x:700,y:600,max_size:7}],"#000000",50),new g(4,"mem7.jpg",[{text:"No",x:150,y:60,max_size:7},{text:"Yes",x:150,y:150,max_size:7}],"#000000",10),new g(5,"mem8.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#FFFFFF",50),new g(6,"mem9.jpg",[{text:"Oyhh",x:350,y:300,max_size:20}],"#000000",50),new g(7,"mem10.jpg",[{text:"Oyhh",x:1e3,y:1e3,max_size:20}],"#FFFFFF",100)}i.a.subscribe((function(e){var t,n,o,a,r,l,m,i;return c.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(t=e.detail,n=t.type,o=t.data,"VKWebAppAccessTokenReceived"==n&&(s=o.access_token),"VKWebAppCallAPIMethodFailed"==n&&console.log(o.error_data),"VKWebAppCallAPIMethodResult"!=n){u.next=24;break}if(o,console.log(1),console.log(o),console.log(1),"mem"!=o.request_id){u.next=24;break}return alert(o.response.upload_url),a=o.response.upload_url,a.replace("https://",""),u.next=14,c.a.awrap(new Promise((function(e){return(void 0).toBlob(e,"image/png")})));case 14:return r=u.sent,(l=new FormData).append("photo",r,"image.png"),u.next=19,c.a.awrap(fetch(p+a,{method:"POST",body:l}));case 19:return m=u.sent,u.next=22,c.a.awrap(m.json());case 22:i=u.sent,alert(i.message);case 24:console.log(o);case 25:case"end":return u.stop()}}))})),i.a.send("VKWebAppInit",{}),x(),i.a.send("VKWebAppGetAuthToken",{app_id:7245851,scope:"friends,photos,groups"});var h=function(e){var t=e.getReader(),n=[];return function e(){return t.read().then((function(t){var o=t.value;return t.done?n:(n.push(o),e())}))}()};function y(e,t,n){return c.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",l()(e).then((function(e){return h(e.body)})).then((function(e){return new File(e,t,{type:n})})));case 1:case"end":return o.stop()}}))}function F(e,t){var n,a,r,l,m,d,g,x,h,F,_,v,f;return c.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,c.a.awrap(i.a.sendPromise("VKWebAppGetAuthToken",{app_id:u,scope:"friends,photos,groups"}));case 2:return b.sent,b.next=5,c.a.awrap(i.a.sendPromise("VKWebAppCallAPIMethod",{method:"photos.getWallUploadServer",params:{access_token:s,v:"5.95"}}));case 5:return n=b.sent,console.log("tophoto"+n),console.log(n),a=n.response.upload_url,r=new FormData,b.t0=r,b.next=13,c.a.awrap(y(e,"story.png","image/png"));case 13:return b.t1=b.sent,b.t0.append.call(b.t0,"photo",b.t1),b.next=17,c.a.awrap(fetch(p+a,{method:"POST",body:r}).then((function(e){return e.json()})));case 17:return l=b.sent,m=l.server,d=l.photo,g=l.hash,console.log(d),b.next=24,c.a.awrap(i.a.sendPromise("VKWebAppCallAPIMethod",{method:"photos.saveWallPhoto",params:{access_token:s,server:m,photo:d,hash:g,v:"5.95"}}));case 24:return x=b.sent,console.log("res: "+x),console.log(x),h=x.response[0],F=h.id,_=h.owner_id,o=_,b.next=31,c.a.awrap(i.a.sendPromise("VKWebAppShowWallPostBox",{message:"",attachments:"photo".concat(_,"_").concat(F),owner_id:-189879960}));case 31:v=b.sent,console.log("res: "+v),console.log(v),(f=document.createElement("input")).className="bottom_input",f.id="share",f.type="button",f.value="\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e",document.getElementById("root").append(f),f.onclick=function(){var e,t,n,a,r,l,m;return c.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,c.a.awrap(i.a.sendPromise("VKWebAppCallAPIMethod",{method:"groups.get",params:{access_token:s,v:"5.95",user_id:o},user_id:o}));case 2:for(a in e=p.sent,console.log(e),t=[],n="",e.response.items)n+=e.response.items[a]+",";return console.log("pub.response"),console.log(e.response),console.log("pub.response.items"),console.log(e.response.items),console.log(n),p.next=14,c.a.awrap(i.a.sendPromise("VKWebAppCallAPIMethod",{group_ids:n,method:"groups.getById",params:{access_token:s,v:"5.95",group_ids:n,fields:"can_post"}}));case 14:for(a in t=p.sent,console.log(t),r=t.response,console.log("_pub.response"),console.log(t.response),l=[],r)1==r[a].can_post&&l.push(r[a]);for(a in l)(m=document.createElement("input")).className="bottom_input",m.type="button",m.value=l[a].name,document.getElementById("root").append(m),m.onclick=function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.awrap(i.a.sendPromise("VKWebAppShowWallPostBox",{message:"",owner_id:-l[a].id,attachments:"photo".concat(-189879960,"_").concat(F)}));case 2:e.sent;case 3:case"end":return e.stop()}}))};case 22:case"end":return p.stop()}}))},t.onclick=function(){var e=x.response[0];console.log(e);var t=x.response[0].sizes[x.response[0].sizes.length-1];console.log(t),console.log("TXT"),console.log(v),console.log("https://vk.com/photo"+String(-189879960)+"_"+v.response[0].id),_=(_=String(_)).replace(" ",""),F=(F=String(F)).replace(" ",""),i.a.send("VKWebAppShare",{link:"https://vk.com/photo"+String(-189879960)+"_"+v.response[0].id})};case 42:case"end":return b.stop()}}))}}},[[5,1,2]]]);
//# sourceMappingURL=main.d0ff298b.chunk.js.map